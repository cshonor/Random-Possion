# 第2章：概率空间（上）

> [← 返回目录](chapter-02-00-index.md) | 下一节：[2.2 数字特征](chapter-02-02-moments-and-expectation.md)

## 2.1 概率空间与随机变量

### 学习要点
- 概率空间的定义（Ω, F, P）
- 随机变量的概念
- 分布函数

### 概率空间一句话（可背诵版）

概率空间 `(Ω, F, P)` 可以理解为三步：

1. 先给出样本空间 `Ω`（所有可能结果）；
2. 再用 `σ`-代数 `F` 圈定“哪些事件可以谈概率”；
3. 最后用概率测度 `P` 给每个 `A ∈ F` 赋值 `P(A) ∈ [0,1]`。

并满足两个核心公理：

- `P(Ω)=1`（总概率为 1）；
- 互不相交事件可列可加（互斥事件概率可加）。

例子（公平掷骰）：

- `Ω = {1,2,3,4,5,6}`；
- `F = P(Ω)`（幂集）；
- 对任意事件 `A ⊆ Ω`，`P(A) = |A|/6`。

这三者合在一起就是一个完整的概率空间。

### 定义1.1.10（有限值随机变量，先入门）

设 `(Ω,F,P)` 为概率空间，函数 `X:Ω->R` 满足：

1. `X` 的取值集合 `X(Ω)` 只包含有限个实数；
2. 对任意 `x∈R`，事件 `{ω∈Ω : X(ω)<=x} ∈ F`（可测性条件）。

则称 `X` 为**有限值随机变量**。

直觉上：`X` 给每个样本点 `ω` 贴一个数值标签，且只会贴出有限种数值；  
并且像“`X<=x`”这样的筛选结果必须是可测事件，才能计算概率。

#### 为什么总写成 `X(ω) <= x`

把 `X(ω) <= x` 理解成“筛选事件”最直接：

- `ω` 是样本点（一次真实发生的结果）；
- `X` 把每个 `ω` 映射成一个实数；
- `X(ω) <= x` 对应的其实是事件 `{ω ∈ Ω : X(ω) <= x}`。

这个事件必须属于 `F`，我们才可以写出概率 `P(X <= x)`。  
因此“对任意实数 `x`，`{ω : X(ω) <= x} ∈ F`”就是可测性的关键条件。

进一步地，这个条件之所以够用，是因为 `(-∞,x]` 这类集合可生成 `R` 上的 Borel `σ`-代数；  
所以只要这些原像可测，就能推出一般 Borel 集的原像也可测。

#### 有限值随机变量（别和“有限样本空间”混淆）

- **有限值随机变量**：`X(Ω)` 只包含有限个实数值；
- 它不要求 `Ω` 必须是有限集。

例子：

- `Ω = {正面, 反面}`，定义 `X(正面)=1, X(反面)=0`；
- 则 `X(Ω)={0,1}`，只有两个取值，所以 `X` 是有限值随机变量。

### 定义1.1.11（n维随机变量）

设 (Ω, F) 为一个可测空间，X = (X₁, X₂, ..., Xn): (Ω, F) → (Rⁿ, B(Rⁿ)) 为可测函数，则称 X 为一个**n维（实值）随机变量**。

**这行符号是什么意思（逐项拆解）**：

- `X = (X1, X2, ..., Xn)`：`X` 是向量值函数，由 `n` 个分量随机变量组成。
- `: (Ω, F) -> (R^n, B(R^n))`：表示函数从可测空间 `(Ω, F)` 映射到可测空间 `(R^n, B(R^n))`。
- `(Ω, F)`：样本空间 `Ω` 及其事件 `σ`-代数 `F`。
- `(R^n, B(R^n))`：`n` 维实数空间及其 Borel `σ`-代数。
- “可测函数”意思是：对任意 `B ∈ B(R^n)`，都有 `{ω ∈ Ω : X(ω) ∈ B} ∈ F`。

一句人话总结：  
每个样本点 `ω` 经过 `X` 都会得到一个 `n` 维向量 `X(ω)`，并且这个映射与可测结构兼容，所以 `P(X ∈ B)` 才有定义。

#### 学习路径建议（先易后难）

很多教材会先给出“一般定义”（`X:(Ω,F) -> (R^n, B(R^n))`），再用离散例子帮助理解。  
你可以按下面顺序学：

1. 先掌握有限值随机变量（事件、原像、`P(X<=x)`）；
2. 再学一般一维随机变量（离散与连续统一视角）；
3. 再扩展到 `n` 维随机变量；
4. 最后进入随机过程（按时间索引的一族随机变量）。

核心始终不变：`ω` 是结果，`X(ω)<=x` 是事件，事件可测才能谈概率。

**一个最直观的小例子（二维随机变量）**：

设一次掷骰：

- `Ω = {1,2,3,4,5,6}`
- `F = P(Ω)`（Ω 的幂集）
- 定义 `X = (X1, X2)`：
  - `X1(ω) = ω`（点数）
  - `X2(ω) = 1_{ω是偶数}`（偶数记 1，奇数记 0）

则：

- `X(1)=(1,0)`，`X(2)=(2,1)`，`X(3)=(3,0)`
- `X(4)=(4,1)`，`X(5)=(5,0)`，`X(6)=(6,1)`

现在取 `R^2` 中的一个 Borel 集：

```
B = (-∞, 3.5] × {1}
```

这里不是“两个区间做交并补”，而是做**笛卡尔积**：

- `(-∞, 3.5]` 约束第一坐标 `x`
- `{1}` 约束第二坐标 `y`

所以

```
B = {(x,y) ∈ R^2 : x <= 3.5, y = 1}
```

等价地也可写成交集形式：

```
B = ((-∞,3.5] × R) ∩ (R × {1})
```

事件 `{ω : X(ω) ∈ B}` 的含义是：

- 第一坐标不超过 `3.5`
- 且第二坐标等于 `1`（表示偶数）

满足条件的只有 `ω = 2`，所以：

```
{ω : X(ω) ∈ B} = {2} ∈ F
```

若掷骰公平，则 `P(X ∈ B) = P({2}) = 1/6`。  
这就展示了“可测性”在计算概率时是怎么落地的。

#### 补充：R^d 到底是什么（超直观）

你可以把 **R^d** 理解成“d 维实数空间”，它不是“d 个实数”，而是一个**空间概念**。

- d = 1：R^1 = R（数轴），点用一个数表示，例如 3.14。
- d = 2：R^2（平面），点用一对数表示，例如 (2, 5)。
- d = 3：R^3（三维空间），点用三个数表示，例如 (x, y, z)。
- d = n：R^n（n 维空间），点写成 (x1, x2, ..., xn)。

所以，R^d 里的元素不是单个实数，而是一个 d 元有序数组：

```
x = (x1, x2, ..., xd),  xi ∈ R
```

#### 和本章内容怎么对应

- 当样本空间取 Ω = R^d 时，我们考虑 d 维空间里的事件。
- 在 d 维里，(a, b] 不再是一维区间，而是左开右闭矩形：
  (a1, b1] × (a2, b2] × ... × (ad, bd]。
- 由这些矩形生成的 σ-代数，就是 d 维 Borel σ-代数 B(R^d)。

这也解释了为什么定义 n 维随机变量时，目标空间写成 (R^n, B(R^n))：  
随机变量不仅要“有函数值”，还要保证“落到目标空间中的事件能谈概率”。

#### 一个二维小例子：R^2 -> Borel -> 概率

设 Z = (X, Y) 是二维随机变量，取值于 R^2。  
对任意 Borel 集 B ⊂ R^2，事件 {Z ∈ B} = {ω : Z(ω) ∈ B} 必须在 F 中，概率 P(Z ∈ B) 才有定义。

例如：

- 若 B = (0.2, 0.6] × (0.1, 0.5]，这是一个 Borel 矩形事件；
- 若 B = {(x, y): x + y ≤ 1}（在单位方形里是三角形），它也是 Borel 集。

结论：  
**R^2 提供取值空间，B(R^2) 提供“可测事件集合”，P(Z ∈ B) 提供事件概率。**

再压缩成一句话就是：

- σ-代数负责规定“哪些集合可以谈概率”；
- Borel 代数 B^d 是 R^d 上最自然的可测集合系统；
- 随机变量可测，保证把 R^d 里的事件拉回 Ω 后仍是可测事件；
- 所以我们才能对 X 的区间/区域事件（如 X ∈ (a, b]）合法地计算概率。

下一步常用的“同一条线”扩展版：

随机变量 -> 分布测度 μ_X(B) = P(X ∈ B) -> 分布函数/密度

#### Borel 代数是什么（一句话版）

Borel 代数（Borel σ-代数）是：  
在实数空间中，由开集（等价地由区间）经过“可数次并、可数次交、取补”生成的最小 σ-代数。

直观上，它就是“实数空间里可以合法谈概率/测度的一整套集合”。

#### 为什么要表述 Borel 集（超直白）

因为概率不能对“所有子集”都随便定义，必须先规定一类“合法事件集合”。

- `σ`-代数负责回答：**哪些集合可以谈概率**。
- 在 `R` 或 `R^d` 上，这类最常用、刚好够用的合法集合就是 Borel 集。
- 你常写的 `P(X<=a)`、`P(a<X<=b)`、`P(X在某个区域)`，对应的集合都属于 Borel 集。
- 所以只有先说清 Borel 集，`P(X∈B)` 才是有定义、可计算的。

一句记忆：

`σ`-代数管“能谈谁”，概率测度 `P` 管“谈到的集合概率是多少”。

#### 工科生防混淆：B(R^2) 和那 6 个点到底啥关系

以掷骰子例子（`Ω={1,2,3,4,5,6}`，`X=(X1,X2)`）为例：

- `R^2`：所有二维实数点的空间（大平面）
- `B(R^2)`：这个平面上的“合法可测集合规则库”（很多很多集合）
- `X(Ω)`：这个例子里 `X` 真正打到的 6 个点（具体输出）

关键纠正：

- 那 6 个点 **属于** `B(R^2)` 里的某些集合；
- 但 `B(R^2)` **不等于** 这 6 个点；
- `B(R^2)` 远比这 6 个点大（包含矩形、开集、闭集、单点、可数并交补后的集合等）。

三层框架（记这个就不混）：

```
样本层：Ω（掷骰结果 1..6）
   --X-->
值域层：R^2（所有二维点）
规则层：B(R^2)（R^2 上哪些集合可谈概率）
```

#### “最小 σ-代数”到底是什么意思

“最小”不是指元素个数最少，而是指**包含关系意义下最小**。

设 C 是一批你想要纳入的基础集合（例如所有开区间，或所有左开右闭区间）。  
那么 σ(C) 定义为：

- 所有“包含 C 的 σ-代数”共同的交集；
- 因而它一定是 σ-代数，且一定包含 C；
- 并且任何包含 C 的 σ-代数都必须包含 σ(C)。

所以说，σ(C) 是“由 C 生成的最小 σ-代数”。

一个小类比：  
你先指定“基础积木”C，再允许三种规则（可数并、可数交、取补）不断搭建。  
最终得到的全部可搭出的集合，就是 σ(C)；它恰好是满足要求的最小闭合系统。

#### 例子：`C = {(1,3)}` 时，`σ(C)` 到底是什么

设 `Ω = R`，`C = {(1,3)}`（注意：`C` 是“集合类”，里面只有一个集合 `(1,3)`）。

按 σ-代数规则，任何包含 `C` 的 σ-代数都必须包含：

- `∅` 和 `R`；
- `(1,3)`（因为它在 `C` 里）；
- `((1,3))^c = (-∞,1] ∪ [3,+∞)`（补集封闭）。

这 4 个集合构成的系统已经对补集与可数并封闭，因此本身就是一个 σ-代数。  
所以：

`σ(C) = {∅, R, (1,3), (-∞,1] ∪ [3,+∞)}`。

同构的有限样本空间版本：

- 若 `Ω = {1,2,3,4}`，`C = {{1,3}}`；
- 则 `σ(C) = {∅, Ω, {1,3}, {2,4}}`。

这和上面的实数例子结构完全一致，都是 `{∅, Ω, A, A^c}`。

#### 通俗问答总结（可背诵版）

一句话 Borel 代数：  
实数集上的 Borel σ-代数，是由全体开集（等价地由全体区间）经过可数并、可数交、取补生成的最小 σ-代数，也是最常用的可测集族。

一句话“最小 σ-代数”：  
由集合族 A 生成的最小 σ-代数，就是所有包含 A 的 σ-代数的交集；它刚好够用，不多给也不少给。

你常问的 4 个点，一次讲清：

- **基本集合 A 是什么**：A 就是“原料集合”，即你一开始指定要放进来的那批集合。  
  在 Borel 场景里，常取 A = 所有开区间（或等价的一类基础区间）。
- **开区间是什么**：`(a,b)`，两端点都不包含。
- **左开右闭是什么**：`(a,b]`，左端不包含、右端包含；它是半开半闭区间，不是开区间。
- **σ-代数和 σ-域**：两个名字是同一个概念。

σ-代数（σ-域）3 条规则（设全集为 Ω）：

1. `Ω ∈ F`；
2. 若 `A ∈ F`，则 `A^c ∈ F`；
3. 若 `A1, A2, ... ∈ F`，则 `A1 ∪ A2 ∪ ... ∈ F`。

“怎么拼”最直白版本：

- 原料：所有开区间；
- 工具：取补、可数并（可推出可数交）；
- 做法：反复用工具，直到不能再产生新类型；
- 成品：所有能这样得到的集合放在一起，就是由开区间生成的 σ-代数，即 `B(R)`。

**解释**：
- (Ω, F) 是可测空间（样本空间和σ-代数）
- X 是一个从可测空间 (Ω, F) 映射到 n 维实数空间 Rⁿ 的函数
- B(Rⁿ) 是 Rⁿ 上的 Borel σ-代数（包含所有开集、闭集、区间等）
- "可测函数"的意思是：对任意 Borel 集 B ∈ B(Rⁿ)，都有 {ω ∈ Ω : X(ω) ∈ B} ∈ F
- 也就是说，X 把可测事件映射到可测事件

**特殊情况**：
- 当 n = 1 时，X 是**一维随机变量**（就是我们最常说的随机变量）
- 当 n > 1 时，X 是**随机向量**（多维随机变量）

**思考**：我们能定义复值随机变量，甚至取值于更一般抽象空间中的随机变量吗？

**答案**：可以！只要目标空间有合适的σ-代数结构，就可以定义随机变量。例如：
- **复值随机变量**：X: (Ω, F) → (C, B(C))，其中 C 是复数空间
- **取值于抽象空间的随机变量**：X: (Ω, F) → (E, E)，其中 (E, E) 是任意可测空间
- 这在随机过程、函数空间中的随机变量等高级理论中非常重要

---

### 定义1.1.12（随机变量的分布和分布函数）

设 X 为 (Ω, F, P) 上的一个 n 维随机变量。

**1. 随机变量的分布（概率测度）**

对任意 B ∈ B(Rⁿ)，令：
```
μ(B) = P(X^(-1)(B))
```

则 μ 定义了 (Rⁿ, B(Rⁿ)) 上的一个**概率测度**，称之为 **X 的分布**。

**解释**：
- X^(-1)(B) 表示"X 落在 B 中的那些样本点"的集合，即 {ω ∈ Ω : X(ω) ∈ B}
- P(X^(-1)(B)) 就是"X 落在 B 中"的概率
- 这样，X 就把概率空间 (Ω, F, P) 上的概率"搬运"到了 (Rⁿ, B(Rⁿ)) 上，形成了新的概率测度 μ
- 这个 μ 就是 X 的分布

**2. 随机变量的分布函数**

对 x = (x₁, x₂, ..., xₙ) ∈ Rⁿ，令：
```
F(x₁, x₂, ..., xₙ) = P(X₁ ≤ x₁, X₂ ≤ x₂, ..., Xₙ ≤ xₙ)
```

称之为 **X 的分布函数**。

**解释**：
- 分布函数 F 给出了"X 的每个分量都不超过某个值"的概率
- 当 n = 1 时，F(x) = P(X ≤ x)，这就是我们熟悉的一维分布函数
- 当 n > 1 时，F(x₁, x₂, ..., xₙ) = P(X₁ ≤ x₁, X₂ ≤ x₂, ..., Xₙ ≤ xₙ)，这是多维分布函数（联合分布函数）

**分布和分布函数的关系**：
- 分布 μ 是概率测度，告诉我们"X 落在任意 Borel 集 B 中"的概率
- 分布函数 F 是分布 μ 的特殊表示，通过"矩形区域"来刻画分布
- 两者完全等价：知道了分布 μ，就能算出分布函数 F；知道了分布函数 F，也能唯一确定分布 μ

#### 两个例子：有限值随机变量与 n 维随机变量

**例1：有限值随机变量（一维）**

设 `Ω={1,2,3,4,5,6}`，`P({k})=1/6`，定义 `X(ω)=ω`（掷骰点数）。

- 分布（概率质量函数）：
  - `P(X=1)=...=P(X=6)=1/6`
- 分布函数：
  - `F_X(x)=0`，`x<1`
  - `F_X(x)=1/6`，`1<=x<2`
  - `F_X(x)=2/6`，`2<=x<3`
  - ...
  - `F_X(x)=1`，`x>=6`

这是有限值随机变量：`X(Ω)={1,2,3,4,5,6}`。

**例2：n 维随机变量（二维）**

设同一概率空间上 `Y=(Y1,Y2)`，其中：

- `Y1(ω)=ω`（点数）
- `Y2(ω)=1_{ω是偶数}`（偶数为1，奇数为0）

则 `Y` 是二维随机变量，取值点为：
`(1,0),(2,1),(3,0),(4,1),(5,0),(6,1)`，各点概率均为 `1/6`。

- 二维分布：由上面 6 个点及其概率给出；
- 二维分布函数：
  - `F_Y(x1,x2)=P(Y1<=x1, Y2<=x2)`。

例如：

- 若 `x2<0`，则 `F_Y(x1,x2)=0`；
- 若 `0<=x2<1`，只统计奇数点：`F_Y(x1,x2)=P(Y1<=x1, Y2=0)`；
- 若 `x2>=1`，则 `F_Y(x1,x2)=P(Y1<=x1)=floor(min(max(x1,0),6))/6`（按 1 到 6 截断理解）。

这个例子展示了：一维分布函数是 `F_X(x)`，n 维分布函数是 `F(x1,...,xn)`，本质相同。

#### 分布函数与离散型：从定义到计算（速记）

这一部分是从“可测映射定义”走向“可计算概率公式”的关键桥梁。

| 概念 | 核心公式 | 直觉含义 |
| :--- | :--- | :--- |
| 分布函数 | `F_X(x)=P(X<=x)` | 统计“随机变量不超过阈值 x”的累计概率 |
| 区间概率 | `P(a<X<=b)=F_X(b)-F_X(a)` | 区间事件可直接由分布函数差值得到 |
| 单点概率 | `P(X=x)=F_X(x)-F_X(x-)` | 跳跃大小就是该点的概率质量 |

这里的逻辑闭环是：

1. 在值域上选 Borel 集 `B`；
2. 用原像得到样本空间事件 `X^{-1}(B)={ω: X(ω)∈B}`；
3. 用 `P` 计算概率：`P_X(B)=P(X^{-1}(B))`。

也就是说，只要 `B` 是 Borel 集，`P(X∈B)` 就是合法且可计算的。

#### 有限值与离散型的关系

- 有限值随机变量：取值只有有限个实数；
- 离散型随机变量：取值可以是有限个，也可以是可数无穷个；
- 因此“有限值”是“离散型”的一个特例。

离散型分布常写成：

`P(X=x_k)=p_k,  k=1,2,...`，且 `p_k>=0`，`∑_k p_k=1`。

#### 金融学习场景提示

二项分布是后续二叉树定价与胜率建模的基础：

`P(X=k)=C_n^k p^k (1-p)^{n-k}`，

表示 `n` 次试验中恰好出现 `k` 次“上涨（成功）”的概率。

---

### Borel σ-代数详解（初学者版）

> **写给刚学概率论、完全没学过测度论的同学**：用大白话讲清楚 Borel σ-代数

---

#### 1. 你现在最需要知道的一句话

你学概率论时，会研究：
- P(X ≤ a)
- P(a < X ≤ b)
- P(X = 2)
- P(X 是有理数)
等等……

**这些事件对应的集合，全都属于 Borel σ-代数。**

简单说：
> **Borel σ-代数 = 实数轴上「一切能定义概率」的集合**

---

#### 2. 超通俗理解（不用任何数学怪话）

想象你在**数轴**上：

1. 最基础的是 **开区间 (a,b)**
2. 然后有 **闭区间 [a,b]**
3. 还有 **半开区间 [a,b)**
4. 还有 **单点 {a}**
5. 还有 **好多个区间拼起来**
6. 甚至像 **有理数全体** 这种奇怪集合

只要你能通过「区间、并、交、补」折腾出来的集合，**全都叫 Borel 集**。

把它们全部打包在一起，就是：**Borel σ-代数**

---

#### 3. 对你现在的概率论，意味着什么？

你只需要记住三句：

1. **我们研究的随机事件，几乎都是 Borel 集**
2. **概率就是定义在 Borel σ-代数上的**
3. 你平时写的 P(X ≤ a)、P(a < X ≤ b) 全都是合法、能算的，因为它们是 Borel 集。

---

#### 4. Ultra 精简版定义（好记）

实数轴 R 上：

> **Borel σ-代数 = 由所有开区间 (a,b) 生成的、能算概率的最小集合系统**

你不用管"σ-代数"那三条公理，你只要记住：
**凡是你能写出来的区间、点、集合，基本都是 Borel 集，都能算概率。**

---

#### 5. 为什么概率论一定要用 Borel σ-代数？

**不用行不行？**

不行！原因很简单：

1. **不是所有集合都能算概率**：
   - 实数轴上存在一些"奇怪"的集合，无法给它们定义概率（这叫"不可测集"）
   - 如果硬要给所有集合都定义概率，会出现矛盾

2. **Borel σ-代数正好够用**：
   - 你平时遇到的所有集合（区间、点、开集、闭集等）都是 Borel 集
   - 这些集合都能算概率，不会出问题

3. **实际应用**：
   - 在金融中，股票价格、收益率等都是连续型随机变量
   - 我们需要计算 P(X ∈ [a, b])、P(X > c) 等，这些都需要 B(R)
   - 正态分布、指数分布等都是定义在 B(R) 上的概率测度

**总结**：Borel σ-代数是"刚好够用、不会出错"的集合系统，是连续型随机变量的"舞台"。

### 金融应用
- 金融资产收益率的概率分布
- 风险评估

### 待补内容
- [ ] 例题练习
- [ ] 代码实现

---
